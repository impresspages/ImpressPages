/*
 * Ext JS Library 1.1
 * Copyright(c) 2006-2007, Ext JS, LLC.
 * licensing@extjs.com
 * 
 * http://www.extjs.com/license
 */


YAHOO.util.Connect={_msxml_progid:["MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],_http_headers:{},_has_http_headers:false,_use_default_post_header:true,_default_post_header:"application/x-www-form-urlencoded",_use_default_xhr_header:true,_default_xhr_header:"XMLHttpRequest",_has_default_headers:true,_default_headers:{},_isFormSubmit:false,_isFileUpload:false,_formNode:null,_sFormData:null,_poll:{},_timeOut:{},_polling_interval:50,_transaction_id:0,setProgId:function(id){this._msxml_progid.unshift(id);},setDefaultPostHeader:function(b){this._use_default_post_header=b;},setDefaultXhrHeader:function(b){this._use_default_xhr_header=b;},setPollingInterval:function(i){if(typeof i=="number"&&isFinite(i)){this._polling_interval=i;}},createXhrObject:function(_5){var _6,_7;try{_7=new XMLHttpRequest();_6={conn:_7,tId:_5};}catch(e){for(var i=0;i<this._msxml_progid.length;++i){try{_7=new ActiveXObject(this._msxml_progid[i]);_6={conn:_7,tId:_5};break;}catch(e){}}}finally{return _6;}},getConnectionObject:function(){var o;var _a=this._transaction_id;try{o=this.createXhrObject(_a);if(o){this._transaction_id++;}}catch(e){}finally{return o;}},asyncRequest:function(_b,_c,_d,_e){var o=this.getConnectionObject();if(!o){return null;}else{if(this._isFormSubmit){if(this._isFileUpload){this.uploadFile(o.tId,_d,_c,_e);this.releaseObject(o);return;}if(_b.toUpperCase()=="GET"){if(this._sFormData.length!=0){_c+=((_c.indexOf("?")==-1)?"?":"&")+this._sFormData;}else{_c+="?"+this._sFormData;}}else{if(_b.toUpperCase()=="POST"){_e=_e?this._sFormData+"&"+_e:this._sFormData;}}}o.conn.open(_b,_c,true);if(this._use_default_xhr_header){if(!this._default_headers["X-Requested-With"]){this.initHeader("X-Requested-With",this._default_xhr_header,true);}}if(this._isFormSubmit||(_e&&this._use_default_post_header)){this.initHeader("Content-Type",this._default_post_header);if(this._isFormSubmit){this.resetFormState();}}if(this._has_default_headers||this._has_http_headers){this.setHeader(o);}this.handleReadyState(o,_d);o.conn.send(_e||null);return o;}},handleReadyState:function(o,_11){var _12=this;if(_11&&_11.timeout){this._timeOut[o.tId]=window.setTimeout(function(){_12.abort(o,_11,true);},_11.timeout);}this._poll[o.tId]=window.setInterval(function(){if(o.conn&&o.conn.readyState==4){window.clearInterval(_12._poll[o.tId]);delete _12._poll[o.tId];if(_11&&_11.timeout){delete _12._timeOut[o.tId];}_12.handleTransactionResponse(o,_11);}},this._polling_interval);},handleTransactionResponse:function(o,_14,_15){if(!_14){this.releaseObject(o);return;}var _16,_17;try{if(o.conn.status!==undefined&&o.conn.status!=0){_16=o.conn.status;}else{_16=13030;}}catch(e){_16=13030;}if(_16>=200&&_16<300){_17=this.createResponseObject(o,_14.argument);if(_14.success){if(!_14.scope){_14.success(_17);}else{_14.success.apply(_14.scope,[_17]);}}}else{switch(_16){case 12002:case 12029:case 12030:case 12031:case 12152:case 13030:_17=this.createExceptionObject(o.tId,_14.argument,(_15?_15:false));if(_14.failure){if(!_14.scope){_14.failure(_17);}else{_14.failure.apply(_14.scope,[_17]);}}break;default:_17=this.createResponseObject(o,_14.argument);if(_14.failure){if(!_14.scope){_14.failure(_17);}else{_14.failure.apply(_14.scope,[_17]);}}}}this.releaseObject(o);_17=null;},createResponseObject:function(o,_19){var obj={};var _1b={};try{var _1c=o.conn.getAllResponseHeaders();var _1d=_1c.split("\n");for(var i=0;i<_1d.length;i++){var _1f=_1d[i].indexOf(":");if(_1f!=-1){_1b[_1d[i].substring(0,_1f)]=_1d[i].substring(_1f+2);}}}catch(e){}obj.tId=o.tId;obj.status=o.conn.status;obj.statusText=o.conn.statusText;obj.getResponseHeader=_1b;obj.getAllResponseHeaders=_1c;obj.responseText=o.conn.responseText;obj.responseXML=o.conn.responseXML;if(typeof _19!==undefined){obj.argument=_19;}return obj;},createExceptionObject:function(tId,_21,_22){var _23=0;var _24="communication failure";var _25=-1;var _26="transaction aborted";var obj={};obj.tId=tId;if(_22){obj.status=_25;obj.statusText=_26;}else{obj.status=_23;obj.statusText=_24;}if(_21){obj.argument=_21;}return obj;},initHeader:function(_28,_29,_2a){var _2b=(_2a)?this._default_headers:this._http_headers;if(_2b[_28]===undefined){_2b[_28]=_29;}else{_2b[_28]=_29+","+_2b[_28];}if(_2a){this._has_default_headers=true;}else{this._has_http_headers=true;}},setHeader:function(o){if(this._has_default_headers){for(var _2d in this._default_headers){if(YAHOO.lang.hasOwnProperty(this._default_headers,_2d)){o.conn.setRequestHeader(_2d,this._default_headers[_2d]);}}}if(this._has_http_headers){for(var _2d in this._http_headers){if(YAHOO.lang.hasOwnProperty(this._http_headers,_2d)){o.conn.setRequestHeader(_2d,this._http_headers[_2d]);}}delete this._http_headers;this._http_headers={};this._has_http_headers=false;}},resetDefaultHeaders:function(){delete this._default_headers;this._default_headers={};this._has_default_headers=false;},setForm:function(_2e,_2f,_30){this.resetFormState();var _31;if(typeof _2e=="string"){_31=(document.getElementById(_2e)||document.forms[_2e]);}else{if(typeof _2e=="object"){_31=_2e;}else{return;}}if(_2f){this.createFrame(_30?_30:null);this._isFormSubmit=true;this._isFileUpload=true;this._formNode=_31;return;}var _32,_33,_34,_35;var _36=false;for(var i=0;i<_31.elements.length;i++){_32=_31.elements[i];_35=_31.elements[i].disabled;_33=_31.elements[i].name;_34=_31.elements[i].value;if(!_35&&_33){switch(_32.type){case"select-one":case"select-multiple":for(var j=0;j<_32.options.length;j++){if(_32.options[j].selected){if(window.ActiveXObject){this._sFormData+=encodeURIComponent(_33)+"="+encodeURIComponent(_32.options[j].attributes["value"].specified?_32.options[j].value:_32.options[j].text)+"&";}else{this._sFormData+=encodeURIComponent(_33)+"="+encodeURIComponent(_32.options[j].hasAttribute("value")?_32.options[j].value:_32.options[j].text)+"&";}}}break;case"radio":case"checkbox":if(_32.checked){this._sFormData+=encodeURIComponent(_33)+"="+encodeURIComponent(_34)+"&";}break;case"file":case undefined:case"reset":case"button":break;case"submit":if(_36==false){this._sFormData+=encodeURIComponent(_33)+"="+encodeURIComponent(_34)+"&";_36=true;}break;default:this._sFormData+=encodeURIComponent(_33)+"="+encodeURIComponent(_34)+"&";break;}}}this._isFormSubmit=true;this._sFormData=this._sFormData.substr(0,this._sFormData.length-1);return this._sFormData;},resetFormState:function(){this._isFormSubmit=false;this._isFileUpload=false;this._formNode=null;this._sFormData="";},createFrame:function(_39){var _3a="yuiIO"+this._transaction_id;if(window.ActiveXObject){var io=document.createElement("<iframe id=\""+_3a+"\" name=\""+_3a+"\" />");if(typeof _39=="boolean"){io.src="javascript:false";}else{if(typeof secureURI=="string"){io.src=_39;}}}else{var io=document.createElement("iframe");io.id=_3a;io.name=_3a;}io.style.position="absolute";io.style.top="-1000px";io.style.left="-1000px";document.body.appendChild(io);},appendPostData:function(_3c){var _3d=[];var _3e=_3c.split("&");for(var i=0;i<_3e.length;i++){var _40=_3e[i].indexOf("=");if(_40!=-1){_3d[i]=document.createElement("input");_3d[i].type="hidden";_3d[i].name=_3e[i].substring(0,_40);_3d[i].value=_3e[i].substring(_40+1);this._formNode.appendChild(_3d[i]);}}return _3d;},uploadFile:function(id,_42,uri,_44){var _45="yuiIO"+id;var _46="multipart/form-data";var io=document.getElementById(_45);this._formNode.action=uri;this._formNode.method="POST";this._formNode.target=_45;if(this._formNode.encoding){this._formNode.encoding=_46;}else{this._formNode.enctype=_46;}if(_44){var _48=this.appendPostData(_44);}this._formNode.submit();if(_48&&_48.length>0){for(var i=0;i<_48.length;i++){this._formNode.removeChild(_48[i]);}}this.resetFormState();var _4a=function(){var obj={};obj.tId=id;obj.argument=_42.argument;try{obj.responseText=io.contentWindow.document.body?io.contentWindow.document.body.innerHTML:null;obj.responseXML=io.contentWindow.document.XMLDocument?io.contentWindow.document.XMLDocument:io.contentWindow.document;}catch(e){}if(_42&&_42.upload){if(!_42.scope){_42.upload(obj);}else{_42.upload.apply(_42.scope,[obj]);}}if(YAHOO.util.Event){YAHOO.util.Event.removeListener(io,"load",_4a);}else{if(window.detachEvent){io.detachEvent("onload",_4a);}else{io.removeEventListener("load",_4a,false);}}setTimeout(function(){document.body.removeChild(io);},100);};if(YAHOO.util.Event){YAHOO.util.Event.addListener(io,"load",_4a);}else{if(window.attachEvent){io.attachEvent("onload",_4a);}else{io.addEventListener("load",_4a,false);}}},abort:function(o,_4d,_4e){if(this.isCallInProgress(o)){o.conn.abort();window.clearInterval(this._poll[o.tId]);delete this._poll[o.tId];if(_4e){delete this._timeOut[o.tId];}this.handleTransactionResponse(o,_4d,true);return true;}else{return false;}},isCallInProgress:function(o){if(o.conn){return o.conn.readyState!=4&&o.conn.readyState!=0;}else{return false;}},releaseObject:function(o){o.conn=null;o=null;}};YAHOO.register("connection",YAHOO.widget.Module,{version:"2.2.0",build:"127"});